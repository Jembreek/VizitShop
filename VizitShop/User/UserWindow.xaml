<Window x:Class="VizitShop.UserWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:VizitShop"
        Title="VizitShop - Личный кабинет"
        Height="680" Width="1150"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5"
        FontFamily="Segoe UI"
        WindowStyle="None"
        AllowsTransparency="True">

    <Window.Resources>
        <local:CartIconConverter x:Key="CartIconConverter"/>

        <Style x:Key="InfoIconStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Ellipse x:Name="BackgroundCircle" Width="24" Height="24" Fill="#20FFFFFF" Opacity="0"/>
                            <TextBlock Text="!" FontWeight="Bold" FontSize="14" Foreground="#424242" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <ToolTipService.ToolTip>
                                <ToolTip x:Name="InfoToolTip" Placement="Bottom" Background="#FFF" BorderBrush="#7C4DFF" BorderThickness="1" HasDropShadow="True">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Brand}" FontWeight="Bold"/>
                                        <TextBlock Text="{Binding Size}" Margin="0,4,0,0"/>
                                    </StackPanel>
                                </ToolTip>
                            </ToolTipService.ToolTip>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="BackgroundCircle" Property="Fill" Value="#107C4DFF"/>
                                <Setter TargetName="BackgroundCircle" Property="Opacity" Value="1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Width" Value="24"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Cursor" Value="Help"/>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid>
                            <Border Name="Border" Background="Transparent" BorderThickness="0" Padding="15 10">
                                <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#7C4DFF"/>
                                <Setter Property="Foreground" Value="#101010"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="False">
                                <Setter Property="Foreground" Value="#424242"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <DataTemplate x:Key="ProductTemplate">
            <Border Background="#FFFFFF" CornerRadius="12" Margin="8" Padding="0" BorderThickness="0">
                <StackPanel Width="260" Height="340">
                    <Button Style="{StaticResource InfoIconStyle}" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="8" Panel.ZIndex="1">
                        <Button.RenderTransform>
                            <ScaleTransform ScaleX="1" ScaleY="1"/>
                        </Button.RenderTransform>
                    </Button>

                    <Border Background="#FAFAFA" CornerRadius="12 12 0 0" Height="180">
                        <Image Source="{Binding ImagePath}" Stretch="UniformToFill" RenderOptions.BitmapScalingMode="HighQuality">
                            <Image.Clip>
                                <RectangleGeometry Rect="0,0,260,180" RadiusX="12" RadiusY="12"/>
                            </Image.Clip>
                        </Image>
                    </Border>

                    <StackPanel Margin="12 8">
                        <TextBlock Text="{Binding Brand}" Foreground="#9E9E9E" FontSize="12" FontWeight="Medium" Margin="0 0 0 2"/>
                        <TextBlock Text="{Binding Name}" FontWeight="SemiBold" TextWrapping="Wrap" FontSize="16" Margin="0 0 0 4" Foreground="#212121" MaxHeight="40" TextTrimming="CharacterEllipsis"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" Margin="0 8 0 0">
                            <TextBlock Text="{Binding Price, StringFormat='{}{0:F0} ₽'}" FontSize="18" FontWeight="Bold" Foreground="#7C4DFF"/>
                            <TextBlock Text="{Binding OldPrice, StringFormat='{}{0:F0} ₽'}" FontSize="13" TextDecorations="Strikethrough" Foreground="#BDBDBD" Margin="8 0 0 0"/>
                        </StackPanel>
                    </StackPanel>

                    <Button Content="В корзину" Background="#7C4DFF" Foreground="White" Margin="4" HorizontalAlignment="Stretch" FontSize="15" FontWeight="SemiBold" Cursor="Hand" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.AddToCartCommand}" CommandParameter="{Binding}">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="border" CornerRadius="8" Background="{TemplateBinding Background}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="#6A40D8"/>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter TargetName="border" Property="Background" Value="#5D36C2"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <Border Background="#7C4DFF" Height="58" VerticalAlignment="Top" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <DockPanel LastChildFill="True">
                <Image Source="/Images/logo.png" Width="120" Height="120" Margin="5 -30 5 0" DockPanel.Dock="Left"/>
                <Button Content="✕" Width="58" Height="58" Background="Transparent" Foreground="White" FontSize="18" Margin="962,0,0,0" FontWeight="SemiBold" BorderThickness="0" Click="CloseButton_Click" Cursor="Hand">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Grid>
                                            <Ellipse x:Name="BackgroundCircle" Width="24" Height="24" Fill="Transparent" Opacity="0"/>
                                            <Ellipse x:Name="RippleEffect" Width="10" Height="10" Fill="#40FFFFFF" Opacity="0" RenderTransformOrigin="0.5,0.5">
                                                <Ellipse.RenderTransform>
                                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                                </Ellipse.RenderTransform>
                                            </Ellipse>
                                            <ContentPresenter x:Name="Content" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Trigger.EnterActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation Storyboard.TargetName="BackgroundCircle" Storyboard.TargetProperty="Opacity" To="0.2" Duration="0:0:0.2"/>
                                                            <ColorAnimation Storyboard.TargetName="BackgroundCircle" Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)" To="#FF5252" Duration="0:0:0.1"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.EnterActions>
                                                <Trigger.ExitActions>
                                                    <BeginStoryboard>
                                                        <Storyboard>
                                                            <DoubleAnimation Storyboard.TargetName="BackgroundCircle" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.3"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </Trigger.ExitActions>
                                            </Trigger>
                                            <EventTrigger RoutedEvent="Button.PreviewMouseDown">
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation Storyboard.TargetName="RippleEffect" Storyboard.TargetProperty="Opacity" From="0" To="0.6" Duration="0:0:0.1"/>
                                                        <DoubleAnimation Storyboard.TargetName="RippleEffect" Storyboard.TargetProperty="(Ellipse.RenderTransform).(ScaleTransform.ScaleX)" To="4" Duration="0:0:0.4"/>
                                                        <DoubleAnimation Storyboard.TargetName="RippleEffect" Storyboard.TargetProperty="(Ellipse.RenderTransform).(ScaleTransform.ScaleY)" To="4" Duration="0:0:0.4"/>
                                                        <DoubleAnimation Storyboard.TargetName="RippleEffect" Storyboard.TargetProperty="Opacity" BeginTime="0:0:0.3" To="0" Duration="0:0:0.3"/>
                                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Content" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)">
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.0" Value="1"/>
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.1" Value="0.8"/>
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.3" Value="1.1"/>
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
                                                        </DoubleAnimationUsingKeyFrames>
                                                        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Content" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)">
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.0" Value="1"/>
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.1" Value="0.8"/>
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.3" Value="1.1"/>
                                                            <LinearDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
                                                        </DoubleAnimationUsingKeyFrames>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
            </DockPanel>
        </Border>

        <DockPanel Margin="0,40,0,0" Height="660" VerticalAlignment="Top">
            <DockPanel.Resources>
                <SolidColorBrush x:Key="AccentColorBrush" Color="#FF3F51B5"/>
                <SolidColorBrush x:Key="AlternateRowBrush" Color="#10FFFFFF"/>

                <Style x:Key="AccentButtonStyle" TargetType="Button">
                    <Setter Property="Background" Value="{StaticResource AccentColorBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="HorizontalAlignment" Value="Center"/>
                    <Setter Property="VerticalAlignment" Value="Center"/>
                    <Setter Property="Cursor" Value="Hand"/>
                    <Setter Property="Padding" Value="8,4"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4" BorderThickness="{TemplateBinding BorderThickness}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

                <Style x:Key="DataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="{StaticResource AccentColorBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Padding" Value="8,6"/>
                </Style>

                <Style x:Key="DataGridCellStyle" TargetType="DataGridCell">
                    <Setter Property="Padding" Value="8,6"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="DataGridCell">
                                <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                    <ContentPresenter VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DockPanel.Resources>

            <TabControl Background="Transparent" BorderThickness="2" Height="621">
                <TabItem Header="Каталог товаров">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <ScrollViewer.Resources>
                            <Style TargetType="ScrollBar">
                                <Setter Property="Opacity" Value="0"/>
                            </Style>
                        </ScrollViewer.Resources>
                        <StackPanel>
                            <ItemsControl ItemsSource="{Binding Products}" ItemTemplate="{StaticResource ProductTemplate}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal" Margin="16,5,0,0"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemContainerStyle>
                                    <Style TargetType="ContentPresenter">
                                        <Setter Property="Margin" Value="0,0,0,0"/>
                                    </Style>
                                </ItemsControl.ItemContainerStyle>
                            </ItemsControl>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <TabItem Header="Мои заказы">
                    <DataGrid ItemsSource="{Binding Orders}" AutoGenerateColumns="False" Background="White" BorderThickness="0" CanUserAddRows="False" HeadersVisibility="Column" RowBackground="Transparent" AlternatingRowBackground="{StaticResource AlternateRowBrush}" ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}" CellStyle="{StaticResource DataGridCellStyle}">
                        <DataGrid.Resources>
                            <Style x:Key="DetailsButtonStyle" TargetType="Button">
                                <Setter Property="Background" Value="#7C4DFF"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Padding" Value="8 4"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="Cursor" Value="Hand"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#6A3DC8"/>
                                                    <Setter TargetName="border" Property="RenderTransform">
                                                        <Setter.Value>
                                                            <ScaleTransform ScaleX="1.02" ScaleY="1.02"/>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter Property="Background" Value="#5E35B1"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </DataGrid.Resources>

                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Номер заказа" Binding="{Binding OrderId}" Width="Auto"/>
                            <DataGridTextColumn Header="Дата" Binding="{Binding OrderDate, StringFormat='dd.MM.yyyy HH:mm'}" Width="Auto">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="Доставлен">
                                                <Setter Property="Foreground" Value="#4CAF50"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="В обработке">
                                                <Setter Property="Foreground" Value="#FFC107"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="Отменен">
                                                <Setter Property="Foreground" Value="#F44336"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Сумма" Binding="{Binding TotalAmount, StringFormat='{}{0:N0} ₽'}" Width="Auto"/>
                            <DataGridTemplateColumn Width="Auto" Header="Действия">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Детали" Command="{Binding DataContext.ViewOrderDetailsCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Style="{StaticResource DetailsButtonStyle}" ToolTip="Просмотреть детали заказа">
                                            <Button.Resources>
                                                <Style TargetType="ToolTip">
                                                    <Setter Property="Background" Value="#333"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                    <Setter Property="BorderThickness" Value="0"/>
                                                    <Setter Property="Padding" Value="6 4"/>
                                                </Style>
                                            </Button.Resources>
                                        </Button>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>
            </TabControl>
        </DockPanel>

        <Button Click="CartButton_Click" Width="40" Height="40" Background="Transparent" Margin="1105 -525 5 0" BorderThickness="0" Cursor="Hand">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Grid>
                                    <Border x:Name="RippleCircle" Width="30" Height="30" CornerRadius="15" Background="Transparent" Opacity="0"/>
                                    <Image x:Name="CartIcon" Source="{Binding IsCartEmpty, Converter={StaticResource CartIconConverter}}" Width="24" Height="24" RenderTransformOrigin="0.5,0.5">
                                        <Image.RenderTransform>
                                            <ScaleTransform x:Name="IconScale" ScaleX="1" ScaleY="1"/>
                                        </Image.RenderTransform>
                                    </Image>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleX" To="1.1" Duration="0:0:0.15"/>
                                                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleY" To="1.1" Duration="0:0:0.15"/>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                        <Trigger.ExitActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.2"/>
                                                    <DoubleAnimation Storyboard.TargetName="IconScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.2"/>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.ExitActions>
                                    </Trigger>
                                    <EventTrigger RoutedEvent="Button.PreviewMouseDown">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="RippleCircle" Storyboard.TargetProperty="Opacity" From="0" To="0.2" Duration="0:0:0.1"/>
                                                <DoubleAnimation Storyboard.TargetName="RippleCircle" Storyboard.TargetProperty="Width" From="10" To="36" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="RippleCircle" Storyboard.TargetProperty="Height" From="10" To="36" Duration="0:0:0.3"/>
                                                <ColorAnimation Storyboard.TargetName="RippleCircle" Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)" From="#007C4DFF" To="#7C4DFF" Duration="0:0:0.1"/>
                                                <DoubleAnimation Storyboard.TargetName="RippleCircle" Storyboard.TargetProperty="Opacity" BeginTime="0:0:0.3" From="0.2" To="0" Duration="0:0:0.3"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Button.Style>
        </Button>

        <Border Background="#FFFFFF" CornerRadius="8" Margin="578,60,50,0" VerticalAlignment="Top" Height="35" BorderThickness="1" BorderBrush="#EEEEEE">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="0" Opacity="0.1" Color="#000000"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="SearchBox" Grid.Column="0" BorderThickness="0" Background="Transparent" Margin="2 0 35 0" VerticalContentAlignment="Center" FontSize="14" Foreground="#424242" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" Tag="Поиск по названию...">
                    <TextBox.InputBindings>
                        <KeyBinding Key="Enter" Command="{Binding SearchCommand}"/>
                    </TextBox.InputBindings>
                </TextBox>
                <Path Grid.Column="0" Data="M15.5,14h-0.8l-0.3-0.3c1-1.1,1.6-2.6,1.6-4.2C16,5.9,13.1,3,9.5,3S3,5.9,3,9.5S5.9,16,9.5,16c1.6,0,3.1-0.6,4.2-1.6l0.3,0.3v0.8l5,5l1.5-1.5L15.5,14z M9.5,14C7,14,5,12,5,9.5S7,5,9.5,5S14,7,14,9.5S12,14,9.5,14z" Stretch="Uniform" Fill="#9E9E9E" Width="18" Height="18" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0 0 15 0"/>
                <ComboBox Grid.Column="1" Width="120" Margin="10 5" SelectedItem="{Binding SelectedPriceFilter}" ItemsSource="{Binding PriceFilters}" DisplayMemberPath="DisplayName" SelectedValuePath="Value" BorderThickness="0" Background="#F5F5F5" Foreground="#424242" FontSize="13" VerticalContentAlignment="Center">
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem">
                            <Setter Property="Background" Value="White"/>
                            <Setter Property="Foreground" Value="#424242"/>
                            <Style.Triggers>
                                <Trigger Property="IsHighlighted" Value="True">
                                    <Setter Property="Background" Value="#7C4DFF"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>
                <Button Grid.Column="2" Content="Сбросить" Width="100" Margin="0 5 10 5" Command="{Binding ResetSearchCommand}" Background="Transparent" Foreground="#7C4DFF" BorderBrush="#7C4DFF" BorderThickness="1" FontSize="13" FontWeight="SemiBold" Cursor="Hand">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border" CornerRadius="4" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#F1E8FF"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>

        <Popup x:Name="CartPopup" Placement="Mouse" StaysOpen="False" AllowsTransparency="True" UseLayoutRounding="True" PopupAnimation="Slide">
            <Popup.Child>
                <Border Background="#F2FFFFFF" BorderBrush="#B0B0B0" BorderThickness="1.5" Width="300" Height="400" CornerRadius="10" ClipToBounds="True">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.3" Color="Black"/>
                    </Border.Effect>
                    <DockPanel LastChildFill="True">
                        <Border DockPanel.Dock="Top" Background="#D9FFFFFF" CornerRadius="10,10,0,0" Padding="10" BorderThickness="0,0,0,1" BorderBrush="#E0E0E0">
                            <TextBlock Text="Корзина" FontSize="20" FontWeight="Bold" Foreground="#212121" HorizontalAlignment="Center"/>
                        </Border>
                        <Border DockPanel.Dock="Bottom" Background="#E6FFFFFF" CornerRadius="0,0,10,10" Padding="10" BorderThickness="0,1,0,0" BorderBrush="#E0E0E0">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 0 0 10">
                                    <TextBlock Text="Итого:" FontSize="16" Margin="0 0 10 0" Foreground="#424242"/>
                                    <TextBlock Text="{Binding TotalPrice, StringFormat='{}{0:N0} ₽'}" FontSize="16" FontWeight="Bold" Foreground="#7C4DFF"/>
                                </StackPanel>
                                <Button Content="Оформить заказ" Background="#7C4DFF" Foreground="White" FontSize="15" FontWeight="Bold" Command="{Binding CheckoutCommand}" Padding="15,8" Cursor="Hand">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Name="border" Background="{TemplateBinding Background}" CornerRadius="6" BorderThickness="0">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#6A3DCC"/>
                                                    <Setter Property="Effect">
                                                        <Setter.Value>
                                                            <DropShadowEffect BlurRadius="8" ShadowDepth="0" Color="#7C4DFF"/>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                        </Border>
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Background="#EBFFFFFF">
                            <DataGrid ItemsSource="{Binding Cart}" AutoGenerateColumns="False" Background="Transparent" BorderThickness="0" HeadersVisibility="Column" CanUserAddRows="False" RowBackground="Transparent" AlternatingRowBackground="#10000000" GridLinesVisibility="None" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Товар" Binding="{Binding Product.Name}" Width="*" Foreground="#212121"/>
                                    <DataGridTextColumn Header="Кол-во" Binding="{Binding Quantity}" Width="Auto" Foreground="#424242"/>
                                    <DataGridTextColumn Header="Цена" Binding="{Binding Total, StringFormat='{}{0:F0} ₽'}" Width="Auto" Foreground="#424242"/>
                                    <DataGridTemplateColumn Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="✕" FontWeight="Bold" Foreground="#F44336" Background="Transparent" BorderThickness="0" Cursor="Hand" Command="{Binding DataContext.RemoveFromCartCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" ToolTip="Удалить из корзины">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Foreground" Value="#D32F2F"/>
                                                                    <Setter Property="Background" Value="#10F44336"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                                <DataGrid.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Setter Property="Padding" Value="10,5"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="DataGridCell">
                                                    <Grid Background="{TemplateBinding Background}">
                                                        <ContentPresenter VerticalAlignment="Center"/>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource Self}}"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.CellStyle>
                            </DataGrid>
                        </ScrollViewer>
                    </DockPanel>
                </Border>
            </Popup.Child>
        </Popup>
    </Grid>
</Window>